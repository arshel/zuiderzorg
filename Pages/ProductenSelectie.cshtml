@page
@using zuiderzorg.Models
@model ProductenSelectie

<h1>@ViewData["Title"]</h1>
<head>
    <link href="~/css/CategoryStyle.css" rel="stylesheet" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.3.0/font/bootstrap-icons.css">
</head>
<body style="background-color:#E9E2E2;">
    <container class="cont">
        <div class="row">
            <div class="col-2">
                <button class="BackButton" onclick="document.location='/nl/Product_Select_Page'" data-bs-toggle="popover" data-bs-trigger="manual" data-bs-title="@localizer.Get("Terug knop")" data-bs-content="@localizer.Get("Met deze knop kunt u terug naar de vorige pagina.")" data-bs-placement="left"> <img src="/images/CatagoryIcons/BackIcon.png" height=100 width=100 /><br /> <strong>Terug</strong></button>
                <button class="HelpButton" onclick="JavaScript:alert('This button is under construction, please remain calm.')">  <img src="/images/CatagoryIcons/InfoIcon.png" height=150 width=150 /><br /> <strong>Vraag om hulp</strong></button>
            </div>
            <div class="col-sm-9" id="buttonsContainer" data-bs-toggle="popover" data-bs-title="@localizer.Get("Producten")" data-bs-content="@localizer.Get("De weergeven producten kunnen u helpen in het dagelijks leven, u kunt deze producten in favorieten toeoegen zodat een mantelzorger deze eventueel voor u kan bestellen.")" data-bs-placement="right" runat="server">
                @{
                    var db = new CategoryContext();
                    var CatInfo = db.Products.Where(x=>x.ParentCategoryId==Guid.Parse(Request.Cookies["CategoryId"])).ToArray();
                    foreach(var item in CatInfo)
                    {
                    <button class="Basic" onclick="document.cookie = 'ProductId=@item.ProductId;path=/;';document.location='/productpagina/product'"> <img src="/images/CatagoryIcons/InfoIcon.png" height=100 width=100 /><br /> <strong>@item.Name</strong> </button>
                    }
                }
                <button class="Add" onclick="openForm()"><img src="/images/CatagoryIcons/PlusIcon.png" height=100 width=100 /><br /><strong>Toevoegen</strong></button>
            </div>
            <div class="col">
                <button class="Arrow" id="ArrowUp" value="false" onclick="scrolling(value)"><i class="bi bi-arrow-up-square-fill" style="font-size:4vw;color:#6CBF2A;position:relative;"></i> <br /> <strong>Naar boven</strong></button>
                <button class="Arrow" id="ArrowDown" value="true" onclick="scrolling(value)"><i class="bi bi-arrow-down-square-fill" style="font-size:4vw;color:#6CBF2A;position:relative;"></i> <br /> <strong>Naar beneden</strong></button>
            </div>      
        </div>
    </container>
    <div class="form-popup" id="myForm">
        <div class="center">
            <form class="form-container" method="post" onsubmit="GetID()">
                <div asp-validation-summary="ModelOnly">
                </div>
                <h1>Toevoegen</h1>
                <label for="ProductRequest.Name"><b>Titel</b></label>
                <input for="ProductRequest.Name" type="text" placeholder="Vul een naam in" name="ProductTitle" required>
                <span asp-validation-for="ProductRequest.Name"> </span>

                <label for="ProductRequest.Price"><b>Prijs</b></label><br />
                <input for="ProductRequest.Price" type="number" placeholder="Vul een prijs in" name="ProductPrice" required>
                <span asp-validation-for="ProductRequest.Price"> </span>

                <label for="ProductRequest.Description"><b>Beschrijving</b></label>
                <input for="ProductRequest.Description" type="text" placeholder="Vul een beschrijving in" name="ProductDescription" required>
                <span asp-validation-for="ProductRequest.Description"> </span>

                <input for="ProductRequest.ParentCategoryId" type="hidden" placeholder="De Id van de hogere categorie" name="CategorieID" id="CategorieID" value="1" required>
                @*<span asp-validation-for="ProductRequest.ParentCategoryId"> </span>*@

                <button type="submit" class="btn">Toevoegen</button>
                <button type="button" class="btn cancel" onclick="closeForm()">Annuleren</button>
            </form>
        </div>
    </div>

    <script>
        function openForm() {
            document.getElementById("myForm").style.display = "block";
        }

        function closeForm() {
            document.getElementById("myForm").style.display = "none";
        }
        function GetID(){
            var fr = document.getElementById("CategorieID");
            return fr.value = localStorage.getItem('CategoryId');
        }

        //Functions for the scrollarrows
        window.onscroll = function() {PositionCheck()};
        window.onload = function () {
            ArrowCheck();
            PositionCheck();
        }

        function scrolling(n) {
        var scrolloffset = $(window).height();
        scrolloffset *= 0.87;
        var top = document.documentElement.scrollTop || document.body.scrollTop;
        if (n == "true") {
            var newscroll = top + scrolloffset;
        } else {
            var newscroll = top - scrolloffset;
        }
        window.scrollTo({ top: newscroll, behavior: 'smooth' })
    }

        function PositionCheck() {
        if (document.documentElement.scrollTop == 0) {
            document.getElementsByClassName("Arrow")[0].style.visibility = "hidden";
        } else {
            document.getElementsByClassName("Arrow")[0].style.visibility = "visible";
        }

        if ((window.innerHeight + window.scrollY) >= document.body.offsetHeight) {
            document.getElementsByClassName("Arrow")[1].style.visibility = "hidden";
        } else {
            document.getElementsByClassName("Arrow")[1].style.visibility = "visible";
        }
    }

        // Function to check if the arrows are neccesary.
        function ArrowCheck() {
            // Only make the up and down arrows appear if there are more than 3 products
            productAmount = $('.Basic').length;
            if (productAmount > 6) {
                document.getElementsByClassName("Arrow")[0].style.visibility = "visible";
                document.getElementsByClassName("Arrow")[1].style.visibility = "visible";
            }
        }
    </script>
</body>